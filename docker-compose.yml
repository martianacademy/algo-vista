version: "3.8"

services:
  # Next.js Web App
  web:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
    volumes:
      - ./.env:/app/.env:ro
    restart: unless-stopped
    container_name: algo-vista-web

  # Binance Futures Trading Bot
  bot-futures:
    build:
      context: .
      dockerfile: Dockerfile
    command: node bots/crypto/cex/auto-trading/auto-trading-futures-binance.js
    environment:
      - NODE_ENV=production
      - SYMBOL=${SYMBOL:-BTC/USDT:USDT}
      - POSITION_SIZE=${POSITION_SIZE:-10}
      - LEVERAGE=${LEVERAGE:-10}
      - STOP_LOSS_PERCENT=${STOP_LOSS_PERCENT:-1}
      - TAKE_PROFIT_PERCENT=${TAKE_PROFIT_PERCENT:-2}
      - CHECK_INTERVAL_SECONDS=${CHECK_INTERVAL_SECONDS:-60}
    env_file:
      - .env
    restart: unless-stopped
    container_name: algo-vista-bot-futures
    depends_on:
      - web

  # Spot Trading Bot (if needed)
  # bot-spot:
  #   build:
  #     context: .
  #     dockerfile: Dockerfile
  #   command: node bots/crypto/cex/auto-trading/auto-trading-ai-modal.js
  #   environment:
  #     - NODE_ENV=production
  #     - SYMBOL=${SYMBOL_SPOT:-BTC/USDT}
  #   env_file:
  #     - .env
  #   restart: unless-stopped
  #   container_name: algo-vista-bot-spot
  #   depends_on:
  #     - web

networks:
  default:
    name: algo-vista-network
